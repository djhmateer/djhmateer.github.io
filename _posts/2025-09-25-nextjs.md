---
layout: post
title: 
description: 
menu: review
categories: nextjs 
published: true 
comments: false     
sitemap: false
image: /assets/2024-05-03/4.jpg
---

<!-- [![alt text](/assets/2025-08-30/6.jpg "Volcano")](/assets/2025-08-30/6.jpg) -->


> Use Next.js like it's PHP/Rails but with React when you need it

- Next.js (App Router)
- Shadcn/ui and Tailwind
- Drizzle
- Postgres

Perhaps

- Lucia or NextAuth or Auth.js - for auth
- Railway/Render - VM for background jobs, websockets, and solid logging, and cost savings


## Bar

I'm building a greenfield app in 2025. I will probably need React on the frontend for some parts of the app to do complex forms and to use the design system shadcn/ui. Other parts of the system are simple CRUD and don't need react. I'd like to host on a VM and have a database. What are my options?

what about other design systems that aren't shadcn/ui?

## Foo

[https://chatgpt.com/share/68d54d0f-0080-8006-a294-650b0b1e9c00](https://chatgpt.com/share/68d54d0f-0080-8006-a294-650b0b1e9c00)

`In next.js or astro, when should one use React and when should one use a server based data fetching / html generational model?

I've used server side frameworks for years such as asp.net, php, ruby on rails. Hosted on a single VM with a separate DB, they can handle huge loads and are easy to debug.

With the advent of react and client side framworks which make javascript interacticity easy they are very commong. 

Firstly why should one use React? What are they parts of a CRUD based application that it shines in?`


### When React is the right tool

React shines anywhere your UI has long-lived client state or rich interactions that would be clumsy as full page reloads.

Sweet spots in CRUD apps

- **Inline editing & optimistic UI** Editable tables, drag-to-reorder, multi-select with bulk actions, undo/snackbar flows.

- **Complex forms**. Conditional fields, debounced validation, nested arrays (e.g., invoices with line items), rich editors, wizards.

- **Realtime views**. Presence indicators, live counters, notifications, collaborative cursors; WebSocket/SSE hooks.

- Reusable design systems. Where a component library and composition pay off across the app.

If a screen is mostly read → click → navigate, React is often overkill.


## How to use Next.js 

If we need React (and I'd argue it is necessary for most modern day apps)

[https://chatgpt.com/share/68d62c71-f5ac-8006-b689-5bf33bfcd055](https://chatgpt.com/share/68d62c71-f5ac-8006-b689-5bf33bfcd055)

For small teams lets flatten the stack:

- Server-first to prevent edge cases, cache revalidation, hydration drift
- VM hosting allows simple logs
- Keep client JS minimal and intentional

## Minimal Next.js stack

As with other stacks where I've been frustrated by complexity (well, frustrated by my own lack of knowledge usually!), lets take the good parts of Next.js and make a great simple stack.

With .NET I found an incredible sweet spot which made developing apps a breeze. I wrote a massive blog post series, and understood the stack well.

- No caching
- No massive ORM (Entity Framework!) but favour simplicity like Dapper
- Migrations I didn't even use
- Keep layers of abstration as simple as possible ie usually only 1 db.cs import (along with global auth)
- Self host so I can reliably deploy (with a bash script to build) and have massive performance.

So with Next.js I wonder

- Server Side Rendering 
- No caching
- Self host on raw VM - just use nginx and node (using pnpm)..systemd.. zero downtime deploy with sym link so can revert.
- Postgres
- Shadcn/ui for pre-built great looking components
- 



## Self Host

[https://medium.com/upcloud/how-to-deploy-next-js-to-cloud-servers-a-step-by-step-guide-bb078bfff6f4](https://medium.com/upcloud/how-to-deploy-next-js-to-cloud-servers-a-step-by-step-guide-bb078bfff6f4)

In the spirit of just code.. and get something working..

- Create a self hosted VM
- bash script to install everything needed for Next.js 

```bash
# Node Version Manager - nvm

# https://github.com/nvm-sh/nvm
# check the version number and put below. This is an update script as well
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash

# restart shell or 
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion


# 0.40.3 on 29th Sept 25
nvm -v

## node 22.20.0 on 29th Sept 25
nvm install --lts

# 10.9.3
npm -v

# update npm.. now 11.6.1 on 29th Sept 25
npm install -g npm

# 10.17.1
npm install -g pnpm


cd /var/www
git clone 

pnpm install

pnpm update

# Nginx
sudo apt-get install nginx -y

# service
mkdir /srv/

sudo git clone https://github.com/djhmateer/minimal-nextjs.git

## chown to a deploy user?

sudo chown -R www-data:www-data /srv/minimal-nextjs

# sudo chmod +x /srv/minimal-nextjs/
sudo chmod 777 /srv/minimal-nextjs/

pnpm run build


# for if git folder has a different owner ie www-root
sudo git config --global --add safe.directory /srv/minimal-nextjs

# nginx is on my reverse proxy
#sudo cp /srv/minimal-nextjs/infra/nginx.conf /etc/nginx/sites-available/default

# test the config
# sudo nginx -t

# sudo nginx -s reload

# systemd or pm2

# manual testing - run the next start server as defined in package.json
pnpm -- start

# test process is running
curl -I http://127.0.0.1:3000

```

then following the [automated installation](https://nextjs.org/docs/app/getting-started/installation)

```bash

# 15.5.4 on 29th Sept 25
pnpx create-next-app@latest minimal-nextjs --ts --eslint --tailwind --no-src-dir --app --turbopack --no-import-alias --use-pnpm

cd minimal-nextjs

# post install scripts
# tailwindcss_oxide
# unrs-resolver
# sharp
pnpm approve-builds

# http://localhost:3000/
pnpm run dev
```

###  Testing locally

I don't have any domain names at the moment, so lets just hit the webserver locally by ip

pfsense2 is on 192.168.1.179
:8080 is pfsense

:80 is just the default reverse proxy ie pfsense forwards to 172.16.44.104 (NGINX-RP)

how about pfsense redirects port 81 to 172.16.44.130:3000

http://192.168.1.179:81/


[![alt text](/assets/2025-09-30/1.jpg "Sample page")](/assets/2025-09-30/1.jpg)

A production build of a sample next.js project.

js is cached well in browser


**HERE** 
I changed a file to Dave2 in source, then did a git pull on the server, now

```bash

pnpm run build
pnpm start

```


