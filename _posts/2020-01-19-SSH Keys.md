---
layout: post
title: SSH Keys 
description: 
menu: review
categories: SSH 
published: true 
comments: false     
sitemap: false
image: /assets/2019-11-13/3.jpg
---

![alt text](/assets/2020-01-09/20.jpg "Connecting to a Linux VM using SSH Keys"){:width="600px"}  

An SSH Key (public/private key pair) is the preferred way to connect to a Linux VM.  The benefits are:

- Don't need a password (super handy)
- More secure as can't brute force

[MS Documentation](https://docs.microsoft.com/en-us/azure/virtual-machines/linux/create-ssh-keys-detailed#overview-of-ssh-and-keys)

## Azure CLI generate-ssh-keys

A handy way to create or use existing ssh keys when creating a new vm on Azure:

```bash
az vm create --name davetest110 --resource-group rg --generate-ssh-keys

## connect to VM
ssh dave@davetest110.westeurope.cloudapp.azure.com

## connect to the VM ignoring initial do you trust prompt
ssh -o StrictHostKeyChecking=no dave@davetest110.westeurope.cloudapp.azure.com
```

Inside WSL this will create or use inside `~/.ssh`

- id_rsa.pub - public key
- id_rsa - private key


## StrictHostKeyChecking

Command is useful to ignore the fingerprint check and add the host to the known_hosts file in `~/.ssh`

![alt text](/assets/2020-01-09/22.jpg "Handy to ignore the fingerprint check"){:width="300px"}  

## Username

![alt text](/assets/2020-01-09/21.jpg "Getting ssh connection string from Azure UI"){:width="400px"}  

I used the above to figure out the username `dave` to connect with. This is the username of the `WSL` user on my Windows machine.

## Files

when doing in WSL it writes to ~/.ssh/
  id_rsa.pub - the public key
  id_rsa - the private key
  known_hosts

when doing from Windows it does:

c:\users\djhma/.ssh/id_rsa
hmmmm generate ssh-keys didn't seem to work
   wrong key?
C:\Users\djhma\.ssh

## Connect from Windows

The above works fine connecting from WSL but I like to connect from Windows too.

## Connect from Multiple Machines to the VM

I use 3 machines to develop on on a regular basis:

- Work desktop machine
- Home laptop
- Home desktop machine

So do I share the public/private keys among these 3 machines to connect to my Azure Linux VM's?

## Manually Create SSH Keys

ssh-keygen -m PEM -t rsa -b 4096

## Passphrases
asdf
